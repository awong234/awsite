<html>
<head>
<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
</head>
<body>
	<div id="viewer" style="width: 50%; margin: auto;"></div>	
<script>
// Get the files as pre-specified by bash script

var baseUrl = [
"/static/photographs",
"/static/photographs/2018",
"/static/photographs/2018/07",
"/static/photographs/2018/07/Scotland",
"/static/photographs/2019",
"/static/photographs/2019/05",
"/static/photographs/2019/07",
]

function getAndDisplayFiles() {
	for (url in baseUrl) {
		let path = baseUrl[url]
		let path_split = path.split("/")
		let year = path_split[3]
		let month = path_split[4]
		let subc = path_split[5]
		$.ajax(path).success(function(data) {
			console.log("This is folder " + path)
			pictures = [];
			$(data).find("a[href]").each(function() {
				var href = $(this).attr('href');
				if (href.indexOf('.jpg') > 0 || href.indexOf('.png') > 0 || href.indexOf('.jpeg') > 0) {
					pictures.push(href);
				}
			});
			console.log(pictures.length + " pictures loaded!");
			// Now append each of these to the "Viewer" div.
			if (pictures.length > 0) {
				console.log("Appending: <h1>" + year + "</h1>")
				$("#viewer").append("<h1>" + year + "</h1>")
				if (month !== undefined) {
					console.log("Appending: <h2>" + month + "</h2>")
					$("#viewer").append("<h2>" + month + "</h2>")
				}
				if (subc !== undefined) {
					console.log("Appending: <h3>" + subc + "</h3>")
					$("#viewer").append("<h3>" + subc + "</h3>")
				}
				pictures.map( (link) => {
					console.log("Appending: <img src='" + path + '/' + link + "'/>")
					$("#viewer").append("<img src='" + path + '/' + link + "' style='width:100%;'/>")
				})
			}			
		});
	}
	
}
getAndDisplayFiles();
</script>
</body>
</html>